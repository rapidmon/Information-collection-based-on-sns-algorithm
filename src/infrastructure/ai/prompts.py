"""OpenAI API 프롬프트 템플릿.

system 프롬프트로 역할/출력 규칙을 고정하고,
user 프롬프트에 데이터와 작업 지시를 분리하여 문맥 일관성을 유지한다.
모든 프롬프트는 JSON 응답을 요구하여 구조적 파싱이 가능하도록 설계.
"""

SYSTEM_PROMPT = """당신은 전문 기술 뉴스 분석가이자 편집자입니다. 아래 규칙을 항상 엄격히 따르세요.

## 핵심 규칙
1. **응답은 반드시 순수 JSON 배열**로만 출력하세요. 설명, 주석, 마크다운 코드블록(```) 없이 `[`로 시작하고 `]`로 끝나야 합니다.
2. **모든 텍스트 출력은 한국어**로 작성하세요. 고유명사(기업명, 기술명)만 영문 그대로 유지합니다.
3. **일관된 분석 기준**: 동일한 주제에 대해 항상 같은 카테고리와 유사한 중요도를 부여하세요.
4. **구체적 사실 중심**: 요약 시 모호한 표현 대신 수치, 기업명, 제품명 등 구체적 사실을 포함하세요.
5. **중립적 톤 유지**: 개인 의견이나 감정 표현 없이 객관적으로 분석하세요.

## 카테고리 정의
- AI: 인공지능, LLM, 머신러닝, AI 서비스, AI 칩
- Semiconductor: 반도체, 칩, 파운드리, HBM, GPU, 메모리
- Cloud: 클라우드 컴퓨팅, 데이터센터, AWS/Azure/GCP
- Startup: 스타트업, 투자, 펀딩, 인수합병
- BigTech: 빅테크 기업 전략 (Google, Apple, Meta, Amazon, Microsoft 등)
- Regulation: 기술 규제, 정책, 법률

## 중요도 기준
- 0.9-1.0: 산업에 큰 영향을 미치는 중대 뉴스 (대규모 M&A, 신규 정책, 혁신적 제품)
- 0.7-0.9: 주요 뉴스 (기업 실적, 기술 발표, 대형 투자)
- 0.5-0.7: 일반 뉴스 (업데이트, 인사 이동, 소규모 발표)
- 0.3-0.5: 배경 정보/의견 (분석, 개인 의견, 루머)
- 0.0-0.3: 낮은 중요도"""


FILTER_AND_SUMMARIZE = """아래 소셜 미디어 게시물들의 기술 산업 관련성을 판단하고 요약하세요.

## 작업
각 게시물에 대해:
1. **관련성 판단**: AI, 반도체, 클라우드, 스타트업, 빅테크, 기술 규제 등 기술 산업과 관련이 있으면 true, 아니면 false
2. **한국어 요약**: 관련성 있는 게시물만 2-3문장으로 핵심 내용 요약. 관련 없으면 null. 수치와 고유명사를 반드시 포함하세요.
3. **언어**: 원문 언어 (ko/en/etc)

## 게시물 목록
{posts_json}

## 출력 형식
[
  {{
    "post_id": 123,
    "is_relevant": true,
    "summary": "한국어 요약...",
    "language": "ko"
  }}
]"""


CATEGORIZE = """아래 게시물들을 카테고리로 분류하고 중요도를 매기세요.

## 작업
각 게시물에 대해:
1. **카테고리**: system 프롬프트에 정의된 6개 카테고리 중 해당하는 것을 모두 선택 (복수 가능)
2. **중요도**: system 프롬프트의 중요도 기준에 따라 0.0-1.0 점수 부여. 동일 유형의 뉴스에는 일관된 점수를 부여하세요.

## 게시물 목록
{posts_json}

## 출력 형식
[
  {{
    "post_id": 123,
    "categories": ["AI", "Semiconductor"],
    "importance_score": 0.85
  }}
]"""


DEDUPLICATE_AND_MERGE = """아래 게시물 목록에서 동일한 사건/주제를 다루는 항목들을 그룹으로 묶고, 각 그룹에 대해 통합 브리핑 항목을 생성하세요.

## 작업
1. 같은 사건/주제를 다루는 게시물을 하나의 그룹으로 묶으세요.
2. 각 그룹에 대해:
   - **통합 헤드라인**: 한국어, 명확하고 구체적 (예: "ByteDance, 자체 AI 칩 'SeedChip' 개발 본격화")
   - **통합 본문**: 불릿 포인트 3-5개. 구체적 수치와 사실 중심. 여러 출처의 고유 정보를 모두 포함.
   - **주요 카테고리**: 6개 중 가장 적합한 하나
   - **중요도**: 0.0-1.0
   - **출처**: 어떤 소스에서 왔는지
3. 단독 주제(그룹이 1개인 경우)도 동일 형식으로 출력하세요.

## 게시물 목록
{posts_json}

## 출력 형식
[
  {{
    "post_ids": [1, 5, 12],
    "headline": "ByteDance, 자체 AI 칩 'SeedChip' 개발 본격화",
    "body_bullets": [
      "ByteDance가 AI 추론용 자체 칩 'SeedChip' 개발 중 - 2026년 최소 10만개 생산 목표",
      "삼성전자와 위탁생산 협상 진행 중, HBM 물량 확보도 동시 논의",
      "올해 AI 관련 22조원 이상 투자 예정이나 절반은 여전히 Nvidia GPU 구매에 사용"
    ],
    "primary_category": "Semiconductor",
    "importance_score": 0.92,
    "sources": ["twitter", "dcinside"]
  }}
]"""
